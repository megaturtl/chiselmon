plugins {
    id 'net.neoforged.gradle.userdev' version "${neogradle_version}"
    id "org.jetbrains.kotlin.jvm" version "${kotlin_version}"
}

base {
    archivesName = "${rootProject.archives_base_name}-neoforge"
}

runs {
    client {
        systemProperty 'forge.logging.console.level', 'debug'
    }
    server {
        systemProperty 'forge.logging.console.level', 'debug'
    }
}

dependencies {
    implementation "net.neoforged:neoforge:${rootProject.neoforge_version}"
    
    // Parchment mappings
    implementation "org.parchmentmc.data:parchment-1.21:${rootProject.parchment_version}@zip"
    
    // Cobblemon
    implementation "com.cobblemon:neoforge:${rootProject.cobblemon_version}+${rootProject.minecraft_version}"
    
    // Cloth Config
    implementation "me.shedaniel.cloth:cloth-config-neoforge:${rootProject.cloth_config_neoforge_version}"
    
    // Common module
    implementation project(path: ":common")
}

tasks.withType(ProcessResources).configureEach {
    var replaceProperties = [
        minecraft_version: rootProject.minecraft_version,
        mod_version: project.version,
        mod_id: rootProject.mod_id,
        mod_name: rootProject.mod_name,
        mod_author: rootProject.mod_author,
        neoforge_version: rootProject.neoforge_version,
        cobblemon_version: rootProject.cobblemon_version
    ]
    
    inputs.properties replaceProperties
    
    filesMatching(['META-INF/neoforge.mods.toml']) {
        expand replaceProperties
    }
}